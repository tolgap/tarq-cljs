(ns tarq-cljs.vulnerability-test
  (:require [tarq-cljs.components.vulnerability :as vuln]
            [tarq-cljs.common-test :refer [append-container!]]
            [dommy.core :as dommy :refer-macros [sel1 sel]]
            [om.core :as om :include-macros true]
            [cljs.test :refer-macros [deftest is testing]]))

(deftest vulnerability-table-row
  (let [c (append-container!)
        data {:title "vuln1"
              :plugin {:name "plugin1"}
              :patched_in ["2.2.3" "3.0.1"]}]
    (testing "shows vuln name, plugin name and patched versions"
      (om/root vuln/vulnerability-table-row data {:target c})
      (is (= "plugin10vuln12.2.3, 3.0.1"
             (dommy/text c))))))
